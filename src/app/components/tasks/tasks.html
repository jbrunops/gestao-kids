<div class="tasks-container">
  <!-- Header -->
  <div class="header">
    <div class="header-left">
      <div class="logo">
        <span class="logo-icon">‚úÖ</span>
        <span class="logo-text">Tempo Kids</span>
      </div>
    </div>
    
    <div class="header-right">
      <nav class="header-nav">
        <a href="#" class="nav-link" (click)="goToDashboard()">Painel</a>
        <a href="#" class="nav-link" (click)="goToReports()">Relat√≥rios</a>
        <a href="#" class="nav-link" (click)="goToSettings()">Configura√ß√µes</a>
      </nav>
      <div class="user-avatar">
        <div class="avatar-placeholder" style="background-color: #696969;">
          P
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <div class="tasks-content">
      <div class="page-header">
        <h1 class="page-title">Gerenciar Tarefas</h1>
        <button class="add-task-button" (click)="openAddTaskModal()">
          ‚ûï Nova Tarefa
        </button>
      </div>
      
      <!-- Filtros -->
      <div class="filters-section">
        <div class="filter-group">
          <label for="childFilter" class="filter-label">Crian√ßa</label>
          <select id="childFilter" [(ngModel)]="selectedChild" (change)="onChildFilterChange()" class="filter-select">
            <option value="">Todas as crian√ßas</option>
            <option *ngFor="let child of children" [value]="child.id">{{ child.name }}</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="statusFilter" class="filter-label">Status</label>
          <select id="statusFilter" [(ngModel)]="selectedStatus" (change)="onStatusFilterChange()" class="filter-select">
            <option value="">Todos os status</option>
            <option value="pending">Pendente</option>
            <option value="in_progress">Em andamento</option>
            <option value="completed">Conclu√≠da</option>
            <option value="overdue">Atrasada</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="priorityFilter" class="filter-label">Prioridade</label>
          <select id="priorityFilter" [(ngModel)]="selectedPriority" (change)="onPriorityFilterChange()" class="filter-select">
            <option value="">Todas as prioridades</option>
            <option value="high">Alta</option>
            <option value="medium">M√©dia</option>
            <option value="low">Baixa</option>
          </select>
        </div>
      </div>

      <!-- Cards de Resumo -->
      <div class="summary-cards">
        <div class="summary-card">
          <div class="card-icon pending-icon">‚è≥</div>
          <div class="card-content">
            <h3 class="card-title">Pendentes</h3>
            <p class="card-value">{{ taskStats.pending }}</p>
          </div>
        </div>
        
        <div class="summary-card">
          <div class="card-icon progress-icon">üîÑ</div>
          <div class="card-content">
            <h3 class="card-title">Em Andamento</h3>
            <p class="card-value">{{ taskStats.inProgress }}</p>
          </div>
        </div>
        
        <div class="summary-card">
          <div class="card-icon completed-icon">‚úÖ</div>
          <div class="card-content">
            <h3 class="card-title">Conclu√≠das</h3>
            <p class="card-value">{{ taskStats.completed }}</p>
          </div>
        </div>
        
        <div class="summary-card">
          <div class="card-icon overdue-icon">‚ö†Ô∏è</div>
          <div class="card-content">
            <h3 class="card-title">Atrasadas</h3>
            <p class="card-value">{{ taskStats.overdue }}</p>
          </div>
        </div>
      </div>

      <!-- Lista de Tarefas -->
      <div class="tasks-section">
        <h2 class="section-title">Tarefas</h2>
        
        <div class="tasks-list">
          <div *ngFor="let task of filteredTasks" class="task-card" [ngClass]="getTaskCardClass(task)">
            <div class="task-header">
              <div class="task-title-section">
                <h3 class="task-title">{{ task.title }}</h3>
                <div class="task-meta">
                  <span class="task-child">{{ getChildName(task.childId) }}</span>
                  <span class="task-due-date">Vence em: {{ task.dueDate }}</span>
                </div>
              </div>
              
              <div class="task-actions">
                <button class="action-button edit-button" (click)="editTask(task)" title="Editar">
                  ‚úèÔ∏è
                </button>
                <button class="action-button delete-button" (click)="deleteTask(task)" title="Excluir">
                  üóëÔ∏è
                </button>
              </div>
            </div>
            
            <div class="task-content">
              <p class="task-description">{{ task.description }}</p>
              
              <div class="task-details">
                <div class="task-priority">
                  <span class="priority-label">Prioridade:</span>
                  <span class="priority-badge" [ngClass]="'priority-' + task.priority">
                    {{ getPriorityText(task.priority) }}
                  </span>
                </div>
                
                <div class="task-status">
                  <span class="status-label">Status:</span>
                  <span class="status-badge" [ngClass]="'status-' + task.status">
                    {{ getStatusText(task.status) }}
                  </span>
                </div>
              </div>
              
              <div class="task-progress" *ngIf="task.status === 'in_progress'">
                <div class="progress-label">Progresso: {{ task.progress }}%</div>
                <div class="progress-bar">
                  <div class="progress-fill" [style.width.%]="task.progress"></div>
                </div>
              </div>
            </div>
            
            <div class="task-footer">
              <div class="task-created">
                Criada em: {{ task.createdAt }}
              </div>
              
              <div class="task-actions-footer">
                <button 
                  *ngIf="task.status === 'pending'" 
                  class="action-button start-button" 
                  (click)="startTask(task)"
                >
                  Iniciar
                </button>
                <button 
                  *ngIf="task.status === 'in_progress'" 
                  class="action-button complete-button" 
                  (click)="completeTask(task)"
                >
                  Concluir
                </button>
                <button 
                  *ngIf="task.status === 'completed'" 
                  class="action-button reopen-button" 
                  (click)="reopenTask(task)"
                >
                  Reabrir
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Adicionar/Editar Tarefa -->
  <div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2 class="modal-title">{{ isEditing ? 'Editar Tarefa' : 'Nova Tarefa' }}</h2>
        <button class="close-button" (click)="closeModal()">‚úï</button>
      </div>
      
      <form [formGroup]="taskForm" (ngSubmit)="onSubmit()" class="modal-form">
        <div class="form-group">
          <label for="title" class="form-label">T√≠tulo</label>
          <input 
            type="text" 
            id="title" 
            formControlName="title"
            class="form-input"
            placeholder="T√≠tulo da tarefa"
          >
        </div>
        
        <div class="form-group">
          <label for="description" class="form-label">Descri√ß√£o</label>
          <textarea 
            id="description" 
            formControlName="description"
            class="form-textarea"
            placeholder="Descri√ß√£o da tarefa"
            rows="3"
          ></textarea>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="childId" class="form-label">Crian√ßa</label>
            <select id="childId" formControlName="childId" class="form-select">
              <option value="">Selecione uma crian√ßa</option>
              <option *ngFor="let child of children" [value]="child.id">{{ child.name }}</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="priority" class="form-label">Prioridade</label>
            <select id="priority" formControlName="priority" class="form-select">
              <option value="low">Baixa</option>
              <option value="medium">M√©dia</option>
              <option value="high">Alta</option>
            </select>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="dueDate" class="form-label">Data de Vencimento</label>
            <input 
              type="date" 
              id="dueDate" 
              formControlName="dueDate"
              class="form-input"
            >
          </div>
          
          <div class="form-group">
            <label for="estimatedTime" class="form-label">Tempo Estimado (min)</label>
            <input 
              type="number" 
              id="estimatedTime" 
              formControlName="estimatedTime"
              class="form-input"
              placeholder="30"
              min="5"
              max="300"
            >
          </div>
        </div>
        
        <div class="modal-actions">
          <button type="button" class="cancel-button" (click)="closeModal()">
            Cancelar
          </button>
          <button type="submit" class="save-button" [disabled]="taskForm.invalid">
            {{ isEditing ? 'Atualizar' : 'Criar' }} Tarefa
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
